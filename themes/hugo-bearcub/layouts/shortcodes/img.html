{{ $src := .Get "src" }}
{{ $alt := .Get "alt" | default "" }}
{{ $caption := .Get "caption" }}
{{ $class := .Get "class" | default "img-responsive" }}

{{ with resources.Get $src }}
  {{ $resized := .Resize "800x" }}
  {{ $webp := $resized | images.Convert "webp" }}
  <figure class="{{ $class }}">
    <picture>
      <source srcset="{{ $webp.RelPermalink }}" type="image/webp">
      <img src="{{ $resized.RelPermalink }}" alt="{{ $alt }}" loading="lazy" />
    </picture>
    {{ with $caption }}
      <figcaption>{{ . }}</figcaption>
    {{ end }}
  </figure>
{{ else }}
  <p style="color:red;">⚠️ Image not found: {{ $src }}</p>
{{ end }}
